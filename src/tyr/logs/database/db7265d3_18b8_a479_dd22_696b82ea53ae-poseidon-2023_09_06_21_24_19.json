{"message": "", "settings": {"column_metadata": "/home/david/olympus/configurations/preprocessing/column_metadata.csv", "datamodel_metadata": "/home/david/olympus/configurations/database/datamodel_metadata.csv", "enable_progress_bar": true, "file_metadata": "/home/david/olympus/configurations/preprocessing/file_metadata.csv", "install": ["spatial"], "merging_run_id": null, "name": "poseidon", "prerequisites": [{"name": "staging", "run_id": "93ad2948_5bee_e6e3_7c22_a7361f8b1849"}, {"name": "datalake", "run_id": "bfb44c6c_01cb_fda5_2d10_817157cb5622"}], "reset": true, "run_id": "db7265d3_18b8_a479_dd22_696b82ea53ae", "threads": 8}}
{"message": "", "start_time": "2023-09-06 21:24:19.820606"}
{"message": "", "time": "2023-09-06 21:24:19.946521", "name": "mint_psd", "type": "BASE TABLE", "sql": "CREATE TABLE _db7265d3_18b8_a479_dd22_696b82ea53ae_mint_psd AS  WITH posn_cte AS (SELECT msg_id, mmsi, source, msg_ts, x, y, sog, rot, nav_status FROM ( SELECT ms01.msg_id AS msg_id, ms01.nav_status AS nav_status, ms01.rot AS rot, ms01.sog AS sog, ms01.x AS x, ms01.y AS y, ms01.msg_ts AS msg_ts, ms01.source AS source, ms01.mmsi AS mmsi FROM _93ad2948_5bee_e6e3_7c22_a7361f8b1849_ms01_stg AS ms01 UNION SELECT ms03.msg_id AS msg_id, ms03.nav_status AS nav_status, ms03.rot AS rot, ms03.sog AS sog, ms03.x AS x, ms03.y AS y, ms03.msg_ts AS msg_ts, ms03.source AS source, ms03.mmsi AS mmsi FROM _93ad2948_5bee_e6e3_7c22_a7361f8b1849_ms03_stg AS ms03 )), intv_cte AS ( SELECT posn.msg_ts AS msg_ts, posn.source AS source, posn.mmsi AS mmsi, posn.msg_id AS msg_id, LAG(msg_ts) OVER(PARTITION BY source, mmsi, msg_id ORDER BY msg_ts DESC) AS lag_msg_ts, CASE WHEN nav_status IN value AND sog < value THEN 180 WHEN nav_status IN value AND sog >= value THEN 10 WHEN sog < value AND rot > value THEN 3.33 WHEN sog < value AND rot <= value THEN 10 WHEN sog < value AND rot > value THEN 2 WHEN sog < value AND rot <= value THEN 6 END AS exp_msg_interval FROM posn_cte AS posn ) SELECT intv.msg_ts AS msg_ts, intv.source AS source, intv.mmsi AS mmsi, intv.msg_id AS msg_id, DATEDIFF('second', intv.msg_ts, intv.lag_msg_ts) AS msg_interval, intv.exp_msg_interval AS exp_msg_interval FROM intv_cte AS intv "}
{"message": "", "time": "2023-09-06 21:24:19.947517", "name": "mint_psd", "type": "BASE TABLE", "sql": "CREATE TABLE _db7265d3_18b8_a479_dd22_696b82ea53ae_mint_psd AS  WITH posn_cte AS (SELECT msg_id, mmsi, source, msg_ts, x, y, sog, rot, nav_status FROM ( SELECT ms01.msg_id AS msg_id, ms01.nav_status AS nav_status, ms01.rot AS rot, ms01.sog AS sog, ms01.x AS x, ms01.y AS y, ms01.msg_ts AS msg_ts, ms01.source AS source, ms01.mmsi AS mmsi FROM _93ad2948_5bee_e6e3_7c22_a7361f8b1849_ms01_stg AS ms01 UNION SELECT ms03.msg_id AS msg_id, ms03.nav_status AS nav_status, ms03.rot AS rot, ms03.sog AS sog, ms03.x AS x, ms03.y AS y, ms03.msg_ts AS msg_ts, ms03.source AS source, ms03.mmsi AS mmsi FROM _93ad2948_5bee_e6e3_7c22_a7361f8b1849_ms03_stg AS ms03 )), intv_cte AS ( SELECT posn.msg_ts AS msg_ts, posn.source AS source, posn.mmsi AS mmsi, posn.msg_id AS msg_id, LAG(msg_ts) OVER(PARTITION BY source, mmsi, msg_id ORDER BY msg_ts DESC) AS lag_msg_ts, CASE WHEN nav_status IN value AND sog < value THEN 180 WHEN nav_status IN value AND sog >= value THEN 10 WHEN sog < value AND rot > value THEN 3.33 WHEN sog < value AND rot <= value THEN 10 WHEN sog < value AND rot > value THEN 2 WHEN sog < value AND rot <= value THEN 6 END AS exp_msg_interval FROM posn_cte AS posn ) SELECT intv.msg_ts AS msg_ts, intv.source AS source, intv.mmsi AS mmsi, intv.msg_id AS msg_id, DATEDIFF('second', intv.msg_ts, intv.lag_msg_ts) AS msg_interval, intv.exp_msg_interval AS exp_msg_interval FROM intv_cte AS intv ", "error_message": "Query to create mint_psd table failed to execute"}
{"message": "", "time": "2023-09-06 21:24:19.947804", "name": "mint_psd", "type": "VIEW", "sql": "CREATE OR REPLACE VIEW mint_psd AS SELECT * FROM _db7265d3_18b8_a479_dd22_696b82ea53ae_mint_psd"}
