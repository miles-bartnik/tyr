{"message": "", "settings": {"column_metadata": "/home/david/olympus/configurations/preprocessing/column_metadata.csv", "datamodel_metadata": "/home/david/olympus/configurations/database/datamodel_metadata.csv", "enable_progress_bar": true, "file_metadata": "/home/david/olympus/configurations/preprocessing/file_metadata.csv", "install": ["spatial"], "merging_run_id": null, "name": "poseidon", "prerequisites": [{"name": "staging", "run_id": "da2db407_1ab5_f833_0d6e_eb58a19fc92a"}, {"name": "datalake", "run_id": "2b734519_8d17_d862_1420_8e677dbaf370"}], "reset": true, "run_id": "c8f260e1_8a47_9523_2cfb_7a5011cd12b8", "threads": 8}}
{"message": "", "start_time": "2023-09-07 00:24:37.042498"}
{"message": "", "time": "2023-09-07 00:24:37.205842", "name": "mint_psd", "type": "BASE TABLE", "sql": "CREATE TABLE _c8f260e1_8a47_9523_2cfb_7a5011cd12b8_mint_psd AS  WITH posn_cte AS (SELECT msg_id, mmsi, source, msg_ts, x, y, sog, rot, nav_status FROM ( SELECT ms01.msg_id AS msg_id, ms01.nav_status AS nav_status, ms01.rot AS rot, ms01.sog AS sog, ms01.x AS x, ms01.y AS y, ms01.msg_ts AS msg_ts, ms01.source AS source, ms01.mmsi AS mmsi FROM _da2db407_1ab5_f833_0d6e_eb58a19fc92a_ms01_stg AS ms01 UNION SELECT ms03.msg_id AS msg_id, ms03.nav_status AS nav_status, ms03.rot AS rot, ms03.sog AS sog, ms03.x AS x, ms03.y AS y, ms03.msg_ts AS msg_ts, ms03.source AS source, ms03.mmsi AS mmsi FROM _da2db407_1ab5_f833_0d6e_eb58a19fc92a_ms03_stg AS ms03 )), intv_cte AS ( SELECT posn.msg_ts AS msg_ts, posn.source AS source, posn.mmsi AS mmsi, posn.msg_id AS msg_id, LAG(msg_ts) OVER(PARTITION BY source, mmsi, msg_id ORDER BY msg_ts DESC) AS lag_msg_ts, CASE WHEN nav_status IN (1, 5) AND sog < 3 THEN 180 WHEN nav_status IN (1, 5) AND sog >= 3 THEN 10 WHEN sog < 14 AND rot > 0 THEN 3.33 WHEN sog < 14 AND rot <= 0 THEN 10 WHEN sog < 23 AND rot > 0 THEN 2 WHEN sog < 23 AND rot <= 0 THEN 6 END AS exp_msg_interval FROM posn_cte AS posn ) SELECT intv.msg_ts AS msg_ts, intv.source AS source, intv.mmsi AS mmsi, intv.msg_id AS msg_id, DATEDIFF('second', intv.msg_ts, intv.lag_msg_ts) AS msg_interval, intv.exp_msg_interval AS exp_msg_interval FROM intv_cte AS intv "}
{"message": "", "time": "2023-09-07 00:24:44.018428", "name": "mint_psd", "type": "VIEW", "sql": "CREATE OR REPLACE VIEW mint_psd AS SELECT * FROM _c8f260e1_8a47_9523_2cfb_7a5011cd12b8_mint_psd"}
{"message": "", "time": "2023-09-07 00:24:44.027086", "name": "vlms_psd", "type": "BASE TABLE", "sql": "CREATE TABLE _c8f260e1_8a47_9523_2cfb_7a5011cd12b8_vlms_psd AS  WITH posn_cte AS (SELECT msg_id, mmsi, source, msg_ts, x, y, sog, rot, nav_status FROM ( SELECT ms01.msg_id AS msg_id, ms01.nav_status AS nav_status, ms01.rot AS rot, ms01.sog AS sog, ms01.x AS x, ms01.y AS y, ms01.msg_ts AS msg_ts, ms01.source AS source, ms01.mmsi AS mmsi FROM _da2db407_1ab5_f833_0d6e_eb58a19fc92a_ms01_stg AS ms01 UNION SELECT ms03.msg_id AS msg_id, ms03.nav_status AS nav_status, ms03.rot AS rot, ms03.sog AS sog, ms03.x AS x, ms03.y AS y, ms03.msg_ts AS msg_ts, ms03.source AS source, ms03.mmsi AS mmsi FROM _da2db407_1ab5_f833_0d6e_eb58a19fc92a_ms03_stg AS ms03 )) SELECT posn.msg_id AS msg_id, posn.source AS source, posn.mmsi AS mmsi, posn.msg_ts AS msg_ts, CASE WHEN sog = 102.3 OR y < -90 OR y > 90 OR x < -180 OR x > 180 THEN FALSE ELSE TRUE END AS valid_message FROM posn_cte AS posn "}
{"message": "", "time": "2023-09-07 00:24:48.392823", "name": "vlms_psd", "type": "VIEW", "sql": "CREATE OR REPLACE VIEW vlms_psd AS SELECT * FROM _c8f260e1_8a47_9523_2cfb_7a5011cd12b8_vlms_psd"}
{"message": "", "time": "2023-09-07 00:24:48.402796", "name": "qlst_psd", "type": "BASE TABLE", "sql": "CREATE TABLE _c8f260e1_8a47_9523_2cfb_7a5011cd12b8_qlst_psd AS  WITH posn_cte AS (SELECT msg_id, mmsi, source, msg_ts, x, y, sog, rot, nav_status FROM ( SELECT ms01.msg_id AS msg_id, ms01.nav_status AS nav_status, ms01.rot AS rot, ms01.sog AS sog, ms01.x AS x, ms01.y AS y, ms01.msg_ts AS msg_ts, ms01.source AS source, ms01.mmsi AS mmsi FROM _da2db407_1ab5_f833_0d6e_eb58a19fc92a_ms01_stg AS ms01 UNION SELECT ms03.msg_id AS msg_id, ms03.nav_status AS nav_status, ms03.rot AS rot, ms03.sog AS sog, ms03.x AS x, ms03.y AS y, ms03.msg_ts AS msg_ts, ms03.source AS source, ms03.mmsi AS mmsi FROM _da2db407_1ab5_f833_0d6e_eb58a19fc92a_ms03_stg AS ms03 )) SELECT posn.mmsi AS mmsi, posn.source AS source, AVG(msg_interval) AS avg_msg_interval FROM vlms_psd AS vlms LEFT JOIN mint_psd AS mint ON vlms.msg_id=mint.msg_id AND vlms.source=mint.source AND vlms.mmsi=mint.mmsi AND vlms.msg_ts=mint.msg_ts LEFT JOIN posn_cte AS posn ON vlms.msg_id=posn.msg_id AND vlms.source=posn.source AND vlms.mmsi=posn.mmsi AND vlms.msg_ts=posn.msg_ts GROUP BY posn.mmsi, posn.source "}
{"message": "", "time": "2023-09-07 00:24:54.827776", "name": "qlst_psd", "type": "VIEW", "sql": "CREATE OR REPLACE VIEW qlst_psd AS SELECT * FROM _c8f260e1_8a47_9523_2cfb_7a5011cd12b8_qlst_psd"}
{"message": "", "end_time": "2023-09-07 00:24:54.841290"}
